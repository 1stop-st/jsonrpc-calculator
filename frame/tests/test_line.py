# coding: UTF-8

from unittest import TestCase
from frame import line
from numpy import allclose


class LineTests(TestCase):
    def test_stiffness_local(self):
        # As a truss
        L = 3.68
        E = 0.201
        A = 0.01635
        k = E * A / L
        a = line.stiffnessLocal(L, E, 0, A)
        self.assertTrue(allclose((
            (k, 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.)), a.next()))
        self.assertTrue(allclose((
            (-k, 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.)), a.next()))
        self.assertTrue(allclose((
            (-k, 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.)), a.next()))
        self.assertTrue(allclose((
            (k, 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.)), a.next()))

    def test_stiffness_global(self):
        # As a truss, no rotation.
        a = line.stiffnessGlobal(1241, 0, 0, 5.2, 0, 12.4)
        self.assertTrue(allclose((
            (0.051958098, 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.)), a.next()))
        self.assertTrue(allclose((
            (-0.051958098, 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.)), a.next()))
        self.assertTrue(allclose((
            (-0.051958098, 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.)), a.next()))
        self.assertTrue(allclose((
            (0.051958098, 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.),
            (0., 0., 0., 0., 0., 0.)), a.next()))
